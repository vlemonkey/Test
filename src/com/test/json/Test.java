package com.test.json;

import java.util.HashMap;
import java.util.Map;

import net.sf.json.JSONObject;

public class Test {

	public static void main(String[] args) {
		String str = "{\"appPath\":\"hdfs:\\/\\/CLOUD238:8020\\/user\\/boco\\/oozie\\/job_minute\",\"acl\":null,\"status\":\"KILLED\",\"createdTime\":\"Mon, 13 May 2013 12:47:00 GMT\",\"conf\":\"<configuration>\\r\\n  <property>\\r\\n    <name>oozie.coord.application.path<\\/name>\\r\\n    <value>hdfs:\\/\\/CLOUD238:8020\\/user\\/boco\\/oozie\\/job_minute<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>startdate<\\/name>\\r\\n    <value>2013-05-08 22:00:00<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>user.name<\\/name>\\r\\n    <value>boco<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>start<\\/name>\\r\\n    <value>2013-05-08T14:10Z<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>redTasks<\\/name>\\r\\n    <value>4<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>queueName<\\/name>\\r\\n    <value>default<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>nameNode<\\/name>\\r\\n    <value>hdfs:\\/\\/CLOUD238:8020<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>workflowAppUri<\\/name>\\r\\n    <value>hdfs:\\/\\/CLOUD238:8020\\/user\\/boco\\/oozie\\/job_minute<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>jobTracker<\\/name>\\r\\n    <value>CLOUD238:8021<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>end<\\/name>\\r\\n    <value>2014-06-30T23:59Z<\\/value>\\r\\n  <\\/property>\\r\\n  <property>\\r\\n    <name>oozie.wf.application.path<\\/name>\\r\\n    <value>hdfs:\\/\\/CLOUD238:8020\\/user\\/boco\\/oozie\\/job_minute<\\/value>\\r\\n  <\\/property>\\r\\n<\\/configuration>\",\"lastModTime\":\"Mon, 13 May 2013 12:48:05 GMT\",\"run\":0,\"endTime\":\"Mon, 13 May 2013 12:48:05 GMT\",\"externalId\":null,\"appName\":\"job_minute\",\"id\":\"0000435-130504162307951-oozie-oozi-W\",\"startTime\":\"Mon, 13 May 2013 12:47:00 GMT\",\"parentId\":\"0000416-130504162307951-oozie-oozi-C@12\",\"toString\":\"Workflow id[0000435-130504162307951-oozie-oozi-W] status[KILLED]\",\"group\":null,\"consoleUrl\":\"http:\\/\\/CLOUD238:11000\\/oozie?job=0000435-130504162307951-oozie-oozi-W\",\"user\":\"boco\",\"actions\":[{\"errorMessage\":null,\"status\":\"OK\",\"stats\":null,\"data\":null,\"transition\":\"find_minutedate_node\",\"externalStatus\":\"OK\",\"cred\":\"null\",\"conf\":\"\",\"type\":\":START:\",\"endTime\":\"Mon, 13 May 2013 12:47:00 GMT\",\"externalId\":\"-\",\"id\":\"0000435-130504162307951-oozie-oozi-W@:start:\",\"startTime\":\"Mon, 13 May 2013 12:47:00 GMT\",\"externalChildIDs\":null,\"name\":\":start:\",\"errorCode\":null,\"trackerUri\":\"-\",\"retries\":0,\"toString\":\"Action name[:start:] status[OK]\",\"consoleUrl\":\"-\"},{\"errorMessage\":null,\"status\":\"OK\",\"stats\":null,\"data\":\"#\\n#Mon May 13 20:47:10 CST 2013\\nlbdate=201305082255\\n\",\"transition\":\"find_daydate_node\",\"externalStatus\":\"SUCCEEDED\",\"cred\":\"null\",\"conf\":\"<java xmlns=\\\"uri:oozie:workflow:0.4\\\">\\r\\n  <job-tracker>CLOUD238:8021<\\/job-tracker>\\r\\n  <name-node>hdfs:\\/\\/CLOUD238:8020<\\/name-node>\\r\\n  <configuration>\\r\\n    <property>\\r\\n      <name>mapred.job.queue.name<\\/name>\\r\\n      <value>default<\\/value>\\r\\n    <\\/property>\\r\\n  <\\/configuration>\\r\\n  <main-class>com.boco.DataPlatform.etl.tools.DateTools<\\/main-class>\\r\\n  <arg>minutedate<\\/arg>\\r\\n  <arg>2013-05-08 22:00:00<\\/arg>\\r\\n  <arg>yyyyMMddHHmm<\\/arg>\\r\\n  <arg>5<\\/arg>\\r\\n  <arg>12<\\/arg>\\r\\n  <capture-output \\/>\\r\\n<\\/java>\",\"type\":\"java\",\"endTime\":\"Mon, 13 May 2013 12:47:10 GMT\",\"externalId\":\"job_201305031717_2469\",\"id\":\"0000435-130504162307951-oozie-oozi-W@find_minutedate_node\",\"startTime\":\"Mon, 13 May 2013 12:47:00 GMT\",\"externalChildIDs\":null,\"name\":\"find_minutedate_node\",\"errorCode\":null,\"trackerUri\":\"CLOUD238:8021\",\"retries\":0,\"toString\":\"Action name[find_minutedate_node] status[OK]\",\"consoleUrl\":\"http:\\/\\/CLOUD238:50030\\/jobdetails.jsp?jobid=job_201305031717_2469\"},{\"errorMessage\":null,\"status\":\"OK\",\"stats\":null,\"data\":\"#\\n#Mon May 13 20:47:20 CST 2013\\nmahout_date=2013-05-08\\n\",\"transition\":\"GN_CLEAR_FILTER_NODE\",\"externalStatus\":\"SUCCEEDED\",\"cred\":\"null\",\"conf\":\"<java xmlns=\\\"uri:oozie:workflow:0.4\\\">\\r\\n  <job-tracker>CLOUD238:8021<\\/job-tracker>\\r\\n  <name-node>hdfs:\\/\\/CLOUD238:8020<\\/name-node>\\r\\n  <configuration>\\r\\n    <property>\\r\\n      <name>mapred.job.queue.name<\\/name>\\r\\n      <value>default<\\/value>\\r\\n    <\\/property>\\r\\n  <\\/configuration>\\r\\n  <main-class>com.boco.DataPlatform.etl.tools.DateMahoutTools<\\/main-class>\\r\\n  <arg>minutedate<\\/arg>\\r\\n  <capture-output \\/>\\r\\n<\\/java>\",\"type\":\"java\",\"endTime\":\"Mon, 13 May 2013 12:47:21 GMT\",\"externalId\":\"job_201305031717_2470\",\"id\":\"0000435-130504162307951-oozie-oozi-W@find_daydate_node\",\"startTime\":\"Mon, 13 May 2013 12:47:11 GMT\",\"externalChildIDs\":null,\"name\":\"find_daydate_node\",\"errorCode\":null,\"trackerUri\":\"CLOUD238:8021\",\"retries\":0,\"toString\":\"Action name[find_daydate_node] status[OK]\",\"consoleUrl\":\"http:\\/\\/CLOUD238:50030\\/jobdetails.jsp?jobid=job_201305031717_2470\"},{\"errorMessage\":null,\"status\":\"KILLED\",\"stats\":null,\"data\":null,\"transition\":null,\"externalStatus\":\"KILLED\",\"cred\":\"null\",\"conf\":\"<map-reduce xmlns=\\\"uri:oozie:workflow:0.4\\\">\\r\\n  <job-tracker>CLOUD238:8021<\\/job-tracker>\\r\\n  <name-node>hdfs:\\/\\/CLOUD238:8020<\\/name-node>\\r\\n  <configuration>\\r\\n    <property>\\r\\n      <name>mapred.mapper.new-api<\\/name>\\r\\n      <value>true<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.reducer.new-api<\\/name>\\r\\n      <value>true<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.job.queue.name<\\/name>\\r\\n      <value>default<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.reduce.tasks<\\/name>\\r\\n      <value>4<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapreduce.inputformat.class<\\/name>\\r\\n      <value>com.boco.DataPlatform.etl.hbgx.ods.ETLLineInputFormat<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapreduce.outputformat.class<\\/name>\\r\\n      <value>org.apache.hadoop.mapreduce.lib.output.TextOutputFormat<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapreduce.map.class<\\/name>\\r\\n      <value>com.boco.DataPlatform.etl.hbgx.ods.MoNetGnCdrPreDoMapper<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapreduce.reduce.class<\\/name>\\r\\n      <value>com.boco.DataPlatform.etl.hbgx.ods.MoNetGnCdrPreDoReducer<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.output.key.class<\\/name>\\r\\n      <value>org.apache.hadoop.io.Text<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.output.value.class<\\/name>\\r\\n      <value>org.apache.hadoop.io.Text<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.inmem.merge.threshold<\\/name>\\r\\n      <value>0<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.job.reduce.input.buffer.percent<\\/name>\\r\\n      <value>1.0<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.input.dir<\\/name>\\r\\n      <value>gndata\\/201305082255\\/*.txt<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>mapred.output.dir<\\/name>\\r\\n      <value>ods\\/0000435-130504162307951-oozie-oozi-W-1<\\/value>\\r\\n    <\\/property>\\r\\n    <property>\\r\\n      <name>oozie.launcher.mapreduce.job.acl-view-job<\\/name>\\r\\n      <value>*<\\/value>\\r\\n    <\\/property>\\r\\n  <\\/configuration>\\r\\n<\\/map-reduce>\",\"type\":\"map-reduce\",\"endTime\":null,\"externalId\":\"job_201305031717_2472\",\"id\":\"0000435-130504162307951-oozie-oozi-W@GN_CLEAR_FILTER_NODE\",\"startTime\":\"Mon, 13 May 2013 12:47:21 GMT\",\"externalChildIDs\":null,\"name\":\"GN_CLEAR_FILTER_NODE\",\"errorCode\":null,\"trackerUri\":\"CLOUD238:8021\",\"retries\":0,\"toString\":\"Action name[GN_CLEAR_FILTER_NODE] status[KILLED]\",\"consoleUrl\":\"http:\\/\\/CLOUD238:50030\\/jobdetails.jsp?jobid=job_201305031717_2472\"}]}";
		test(str);
	}
	
	public static void test(String str) {
		Map<String, Class<OozieChild>> classMap = new HashMap<String, Class<OozieChild>>();
		classMap.put("actions", OozieChild.class);
		JSONObject object = JSONObject.fromObject(str);
		OozieParent parent = (OozieParent)JSONObject.toBean(object, OozieParent.class, classMap);
		System.out.println(parent.getActions().get(1).getConsoleUrl());
	}
}
